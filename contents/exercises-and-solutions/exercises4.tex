%% EXERCISE SET 4 %%
\section{Exercise Set 4}

% EXERCISE 11
\begin{exercise}
Let $\mathcal{F}$ be a class of functions $f \colon \mathcal{X} \to \R$, and let $X_1, \dots, X_n$ be i.i.d.\ random variables with values in $\mathcal{X}$. Further, let $\sigma_1, \dots, \sigma_n$ be i.i.d.\ $\Rad(\nicefrac{1}{2})$ random variables that are independent of $X_1, \dots, X_n$. Prove the \emph{desymmetrization inequality}:
\[
    \Exp\left[\sup_{f \in \mathcal{F}} \abs{\frac{1}{n} \sum_{i=1}^n \sigma_i (f(X_i) - \Exp[f(X_i)])}\right] \leq 2 \Exp\left[\sup_{f \in \mathcal{F}} \abs{\frac{1}{n} \sum_{i=1}^n (f(X_i) - \Exp[f(X_i)])}\right].
\]
\end{exercise}


% EXERCISE 12
\begin{exercise}
Let $\mathcal{F}$ be a class of functions $f \colon \mathcal{X} \to \R$, and let $X_1, \dots, X_n$ be i.i.d.\ random variables with values in $\mathcal{X}$. Further, let $\sigma_1, \dots, \sigma_n$ be i.i.d.\ $\Rad(\nicefrac{1}{2})$ random variables, and let $g_1, \dots, g_n$ be i.i.d.\ $\mathcal{N}(0, 1)$ random variables. Finally, assume that $X_1, \dots, X_n, \sigma_1, \dots, \sigma_n, g_1, \dots, g_n$ are independent.
\begin{enumerate}
    \item Prove $g_i \stackrel{d}{=} \sigma_i \abs{g_i}$.

    \item Show that $\Exp[\abs{g_i}] = \sqrt{2 / \pi}$.

    \item Derive the following Rademacher-Gaussian comparison inequality:
            \[
                \Exp\left[\sup_{f \in \mathcal{F}} \abs{\sum_{i=1}^n \sigma_i f(X_i)}\right] \leq \sqrt{\frac{\pi}{2}} \Exp\left[\sup_{f \in \mathcal{F}} \abs{\sum_{i=1}^n g_i f(X_i)}\right] .
            \]
\end{enumerate}
\end{exercise}


% EXERCISE 13
\begin{exercise}
Let $f \colon C \to \R$ be a $K$-Lipschitz function defined on a compact domain $C \subset \R^d$ with finite diameter\footnote{The diameter of a subset $X \subset \R^d$ is given by $\operatorname{diam}(X) = \sup_{x, y \in X} \norm{x - y}_2$.} $\operatorname{diam}(C) < \infty$, i.e.,
\[
    \norm{f(x) - f(y)}_2 \leq K \norm{x - y}_2, \quad x, y \in C.
\]
Further, assume that $f$ is \emph{$\beta$-smooth}, i.e., there exists $\beta > 0$ such that
\[
    f(y) - f(x) \leq \nabla f(x)^{\top} (y - x) + \frac{\beta}{2} \norm{y - x}_2^2, \quad x, y \in C.
\]
We define a sequence $(x_n)_{n \in \N}$ by
\[
    x_{n+1} = (1 - \alpha_n)x_n + \alpha_n y_n,
\]
where $\alpha_n = 2 / (n+1)$ and $y_n \in \argmin_{y \in C} \nabla f(x_n)^{\top} y$.
\begin{enumerate}
    \item Show that
            \[
                f(x_{n+1}) - f(x_n) \leq \alpha_n (f(x^*) - f(x_n)) + \frac{\beta}{2} \alpha_n^2 R^2,
            \]
        where $x^{*} \in \argmin_{x \in C} f(x)$ is a local minimum of $f$ and $R = \operatorname{diam}(C)$ is the diameter of $C$.

    \item Conclude that
            \[
                f(x_n) - f(x^*) \leq \frac{2 \beta R^2}{n + 1}, \quad n \geq 2.
            \]
\end{enumerate}
\end{exercise}
