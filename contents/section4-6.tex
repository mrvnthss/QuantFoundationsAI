%% SECTION 4.6 %%
\section{A \qq{Fast Rate} VC Inequality}

While the VC inequality stated in Section \ref{sec: VC inequality} was of rate $\sqrt{\log(n) / n}$ (i.e., \qq{slow}), there also exists an upper bound that decreases exponentially fast.

\begin{theorem}[Vapnik-Chervonenkis, 1971]
\label{thm: fast rate VC inequality}
For a probability measure $\mu$ and a collection of measurable sets $\mathcal{A}$, it holds
\[
    \Pr{ \sup_{A \in \mathcal{A}} \abs{\mu_n(A) - \mu(A)} > \varepsilon } \leq 8 \mathcal{S}_{\mathcal{A}}(n) \e^{-n\varepsilon^2/32}
\]
for all $n \geq 1$ and $\varepsilon > 0$.
\end{theorem}

The proof of this statement (which we omit) is similar to the proof of an important result by Glivenko-Cantelli (see below), both of which can be found in Chapter 12 of  \cite{devroye1996probabilistic}.

\begin{theorem}[Fundamental Theorem of Statistics {[Glivenko-Cantelli, 1933]}]
\label{thm: glivenko-cantelli}
Let $X_1, \dots, X_n$ be i.i.d. random variables with distribution function $F(t)$ and denote the corresponding empirical distribution function by $F_n(t)$. Then,
\[
    \Pr{ \sup_{t\in\R} \abs{F_n(t) - F(t)} > \varepsilon } \leq 8(n+1) \e^{-n\varepsilon^2/32}.
\]
In particular, by the Borel-Cantelli lemma,
\[
    \sup_{t\in\R} \abs{F_n(t) - F(t)} \xrightarrow{\mathrm{a.s.}} 0.
\]
\end{theorem}

\begin{remark}
While the proofs of the two statements are quite similar, the fast rate VC inequality (Theorem \ref{thm: fast rate VC inequality}) also directly implies the result by Glivenko-Cantelli (Theorem \ref{thm: glivenko-cantelli}): for $t \in \R$, define $A_t = (-\infty, t]$ and let $\mathcal{A} = \set{A_t \with t \in \R}$. Clearly, $\mathcal{A}$ is a collection of measurable sets. Further, it is easy to see that $\mathcal{A}$ can only generate binary patterns of $1$s followed by $0$s. Hence, the $n$-th shatter coefficient $\mathcal{S}_{\mathcal{A}}(n)$ of $\mathcal{A}$ is given by $n+1$. Finally, we define a measure $\mu$ by $\mu(A) = \Pr{X \in A}$ for any measurable set $A$ (not necessarily in the collection $\mathcal{A}$), where $X \sim F$. In that case, we have $\mu(A_t) = \Pr{X \in A_t} = \Pr{X \leq t} = F(t)$ and $\mu_n(A_t) = \frac{1}{n} \sum_{i=1}^n \indSet{X_i \in A_t} = \frac{1}{n} \sum_{i=1}^n \indSet{X_i \leq t} = F_n(t)$. Altogether,
\[
    \Pr{ \sup_{t\in\R} \abs{F_n(t) - F(t)} > \varepsilon } = \Pr{ \sup_{A \in \mathcal{A}} \abs{\mu_n(A) - \mu(A)} > \varepsilon } \leq 8 \mathcal{S}_{\mathcal{A}}(n) \e^{-n\varepsilon^2/32} = 8 (n+1) \e^{-n\varepsilon^2/32}.
\]
\end{remark}
